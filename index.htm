<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Compra laptops, redes y accesorios tecnológicos al mejor precio en Tecomred." />
    <meta name="author" content="Tecomred" />
    <meta property="og:title" content="Tienda Tecomred - Tecnología a tu alcance" />
    <meta property="og:description" content="Compra laptops, redes y accesorios tecnológicos al mejor precio en Tecomred." />
    <meta property="og:image" content="https://tudominio.com/logo.png" />
    <title>Tienda Tecomred</title>
    <link rel="icon" href="https://img.icons8.com/plasticine/100/000000/laptop.png" type="image/png">
    <link rel="stylesheet" href="estilos.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
        /* Estilos CSS añadidos y modificados para el carrito y el bot */
        .carrito {
            position: fixed;
            top: 0;
            right: 0;
            width: 350px;
            height: 100%;
            background-color: #f8f9fa;
            box-shadow: -2px 0 5px rgba(0,0,0,0.2);
            transform: translateX(100%);
            transition: transform 0.3s ease-in-out;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            padding: 20px;
        }
        .carrito.abierto {
            transform: translateX(0);
        }
        .carrito-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 2px solid #e9ecef;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        .items-carrito {
            list-style: none;
            padding: 0;
            margin: 0;
            overflow-y: auto;
            flex-grow: 1;
        }
        .items-carrito li {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px dashed #ced4da;
        }
        .resumen-carrito {
            margin-top: 20px;
            padding-top: 10px;
            border-top: 2px solid #e9ecef;
        }
        .btn-carrito-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 20px;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            z-index: 1001;
        }
        .carrito-item-info {
            flex-grow: 1;
        }
        .carrito-item-info h4 {
            margin: 0;
            font-size: 16px;
        }
        .carrito-item-info p {
            margin: 5px 0 0;
            font-size: 14px;
            color: #6c757d;
        }
        .btn-eliminar-item {
            background: none;
            border: none;
            color: #dc3545;
            font-size: 18px;
            cursor: pointer;
        }
        .productos-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        .card-producto {
            border: 1px solid #ddd;
            border-radius: 8px;
            overflow: hidden;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: transform 0.2s;
            padding-bottom: 15px;
        }
        .card-producto:hover {
            transform: translateY(-5px);
        }
        .card-producto img {
            max-width: 100%;
            height: auto;
        }
        .card-producto h3 {
            margin: 10px 0;
            font-size: 18px;
        }
        .card-producto p {
            font-size: 16px;
            color: #007bff;
            font-weight: bold;
        }
        .card-producto button {
            background-color: #28a745;
            color: white;
            border: none;
            padding: 10px 20px;
            cursor: pointer;
            border-radius: 5px;
            margin-top: 10px;
        }
        /* Estilos para el bot de chat */
        .chat-bot-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1002;
        }
        .chat-bot-btn {
            background-color: #6c5ce7;
            color: white;
            border: none;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .chat-window {
            background-color: white;
            border: 1px solid #ddd;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            width: 300px;
            height: 400px;
            position: absolute;
            bottom: 70px;
            right: 0;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        .chat-header {
            background-color: #6c5ce7;
            color: white;
            padding: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-radius: 10px 10px 0 0;
        }
        .chat-header h3 {
            margin: 0;
        }
        .chat-close-btn {
            background: none;
            border: none;
            color: white;
            font-size: 20px;
            cursor: pointer;
        }
        .chat-messages {
            flex-grow: 1;
            padding: 15px;
            overflow-y: auto;
            background-color: #f1f0f0;
        }
        .chat-message {
            margin-bottom: 10px;
            padding: 8px 12px;
            border-radius: 15px;
            max-width: 80%;
        }
        .message-bot {
            background-color: #e2e2e2;
            align-self: flex-start;
        }
        .message-user {
            background-color: #6c5ce7;
            color: white;
            align-self: flex-end;
            margin-left: auto;
        }
        .chat-input-area {
            display: flex;
            padding: 10px;
            border-top: 1px solid #ddd;
        }
        .chat-input {
            flex-grow: 1;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 20px;
            margin-right: 10px;
        }
        .chat-send-btn {
            background-color: #6c5ce7;
            color: white;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            cursor: pointer;
        }
    </style>
</head>
<body>

    <button id="mostrar-carrito" class="btn-carrito-toggle" type="button" aria-label="Mostrar carrito de compras" aria-controls="carrito" aria-expanded="false">
        <i class="fas fa-shopping-cart"></i>
    </button>

    <header class="encabezado" role="banner">
        <div class="header-contenido">
            <h1>Bienvenido a Tecomred</h1>
            <p>Encuentra tus productos favoritos al mejor precio</p>
            <div class="auth-buttons">
                <button id="btn-login" class="btn-auth">Iniciar Sesión</button>
                <button id="btn-register" class="btn-auth">Registrarse</button>
                <span id="user-display" class="user-display" style="display:none;"></span>
                <button id="btn-logout" class="btn-auth" style="display:none;">Cerrar Sesión</button>
            </div>
        </div>
        <nav role="navigation" aria-label="Menú principal del sitio">
            <ul class="nav-links">
                <li><a href="#productos">Productos</a></li>
                <li><a href="#metodo-pago">Pago</a></li>
                <li><a href="#contacto">Contacto</a></li>
            </ul>
        </nav>
    </header>

    <main class="contenido" role="main">

        <section id="filtros" class="filtros" aria-label="Filtros de productos">
            <h2>Filtrar productos</h2>
            <div class="filtros-grupo">
                <label for="filtro-categoria">Categoría:</label>
                <select id="filtro-categoria" aria-controls="contenedor-productos">
                    <option value="todos">Todos</option>
                    <option value="Laptops">Laptops</option>
                    <option value="Accesorios">Accesorios</option>
                    <option value="Componentes">Componentes</option>
                    <option value="Redes">Redes</option>
                </select>
            </div>

            <div class="filtros-grupo">
                <label for="filtro-precio">Precio máximo:</label>
                <input type="range" id="filtro-precio" min="0" max="5000" step="100" value="5000" aria-valuemin="0" aria-valuemax="5000" aria-valuenow="5000" aria-valuetext="S/ 5000"/>
                <span id="precio-mostrar">S/ 5000</span>
            </div>

            <div class="filtros-grupo">
                <label for="buscador">Buscar por nombre:</label>
                <input type="text" id="buscador" placeholder="Ej. SSD, router, cable..." aria-label="Buscar producto por nombre" />
            </div>
            <button id="btn-limpiar-filtros" class="btn-secundario">Limpiar Filtros</button>
        </section>

        <aside id="carrito" class="carrito" aria-label="Carrito de compras" aria-hidden="true">
            <div class="carrito-header">
                <h2><i class="fas fa-shopping-cart"></i> Carrito</h2>
                <button id="ocultar-carrito" class="btn-flecha" aria-label="Ocultar carrito" aria-controls="carrito" aria-expanded="true">
                    <i class="fas fa-chevron-right"></i>
                </button>
            </div>
            <ul id="lista-carrito" class="items-carrito" role="list">
                <li id="carrito-vacio-mensaje" class="carrito-vacio-mensaje" role="alert">Tu carrito está vacío.</li>
            </ul>
            <div class="resumen-carrito">
                <p class="carrito-total-p">Total: <span id="carrito-total">S/ 0.00</span></p>
                <button id="btn-vaciar" class="btn-secundario">Vaciar carrito</button>
                <button id="btn-ir-pago" class="btn-primario">Ir a Pagar</button>
            </div>
        </aside>

        <section id="servicios-tienda" class="seccion-servicios">
            <h2>¿Qué necesitas hoy?</h2>
            <div class="botones-servicios">
                <a href="#mantenimiento" class="btn-contacto"><i class="fas fa-tools"></i> Mantenimiento Técnico</a>
                <a href="#venta" class="btn-contacto"><i class="fas fa-laptop"></i> Venta de Productos</a>
            </div>
        </section>

        <section id="mantenimiento" class="contacto">
            <h2><i class="fas fa-screwdriver-wrench"></i> Servicio Técnico</h2>
            <p>Ofrecemos mantenimiento y reparación de laptops, PCs, redes y más.</p>
        </section>

        <section id="venta" class="contacto">
            <h2><i class="fas fa-store"></i> Venta de Tecnología</h2>
            <p>Encuentra laptops, accesorios, componentes, routers y más a precios especiales.</p>
        </section>

        <section id="productos" class="seccion-productos">
            <h2>Productos disponibles</h2>
            <div class="productos-container" id="contenedor-productos" role="grid" aria-live="polite" aria-relevant="additions removals">
            </div>
            <p id="no-productos-mensaje" class="mensaje-info" style="display:none;" role="alert">No se encontraron productos con los filtros aplicados.</p>
        </section>

        <section id="metodo-pago" class="seccion-pago">
            <h2>Método de pago</h2>
            <form id="form-pago" class="formulario-pago">
                <div class="grupo-formulario">
                    <label for="nombre-pago">Nombre completo*</label>
                    <input type="text" id="nombre-pago" required autocomplete="name" placeholder="Juan Pérez" />
                </div>
                <div class="grupo-formulario">
                    <label for="email-pago">Correo electrónico*</label>
                    <input type="email" id="email-pago" required autocomplete="email" placeholder="email@ejemplo.com" />
                </div>
                <div class="grupo-formulario">
                    <label for="metodo">Método de pago*</label>
                    <select id="metodo" required>
                        <option value="">Selecciona un método</option>
                        <option value="tarjeta">Tarjeta de crédito/débito</option>
                        <option value="transferencia">Transferencia bancaria</option>
                        <option value="yape">Yape / Plin (Perú)</option>
                    </select>
                </div>

                <div id="detalles-pago-tarjeta" class="detalles-pago-tarjeta" style="display:none;">
                    <h3>Detalles de la Tarjeta</h3>
                    <div class="grupo-formulario">
                        <label for="numero-tarjeta">Número de tarjeta*</label>
                        <input type="text" id="numero-tarjeta" placeholder="XXXX XXXX XXXX XXXX" maxlength="19" inputmode="numeric" pattern="[0-9]{13,19}" title="Ingrese un número de tarjeta válido (13-19 dígitos)" autocomplete="cc-number" />
                    </div>
                    <div class="grupo-formulario">
                        <label for="fecha-expiracion">Fecha de expiración (MM/AA)*</label>
                        <input type="text" id="fecha-expiracion" placeholder="MM/AA" maxlength="5" pattern="(0[1-9]|1[0-2])\/?([0-9]{2})" title="Ingrese una fecha de expiración válida (MM/AA)" autocomplete="cc-exp" />
                    </div>
                    <div class="grupo-formulario">
                        <label for="cvv">CVV*</label>
                        <input type="text" id="cvv" placeholder="XXX" maxlength="4" inputmode="numeric" pattern="[0-9]{3,4}" title="Ingrese un CVV válido (3 o 4 dígitos)" autocomplete="cc-csc" />
                    </div>
                </div>

                <div class="grupo-formulario checkbox-label">
                    <input type="checkbox" id="acepta-terminos" required />
                    <label for="acepta-terminos">Acepto los <a href="#" target="_blank" rel="noopener noreferrer" aria-label="Leer términos y condiciones">términos y condiciones</a></label>
                </div>

                <p id="pago-mensaje" class="mensaje-pago mensaje-exito" role="status" aria-live="polite" style="display:none;"></p>
                <p id="pago-error" class="mensaje-pago mensaje-error" role="alert" aria-live="assertive" style="display:none;"></p>

                <button type="submit" class="btn-primario">Confirmar Pago</button>
            </form>
        </section>

        <section id="contacto" class="contacto">
            <h2>Contacto</h2>
            <p><strong>Ubicación:</strong> Jr. Sinchi Roca #391, Baños del Inca, Cajamarca, Perú</p>
            <div class="botones-contacto">
                <a href="https://wa.me/51997176721" class="btn-contacto" target="_blank" rel="noopener noreferrer"><i class="fab fa-whatsapp"></i> WhatsApp</a>
                <a href="mailto:tecomred.tcr@gmail.com" class="btn-contacto"><i class="fas fa-envelope"></i> Correo</a>
                <a href="tel:+51997176721" class="btn-contacto"><i class="fas fa-phone"></i> Llamar</a>
            </div>
            <div class="mapa">
                <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3957.3770308070987!2d-78.50809802528766!3d-7.311749592686866!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x91b2c45f958444e9%3A0x6b6d5f7560824b22!2sJr.%20Sinchi%20Roca%20%23391%2C%20Ba%C3%B1os%20del%20Inca%2006000!5e0!3m2!1ses-419!2spe!4v1719230571342!5m2!1ses-419!2spe" width="100%" height="300" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade" title="Ubicación de Tecomred en Google Maps"></iframe>
            </div>
        </section>

    </main>

    <footer class="pie-pagina" role="contentinfo">
        <p>© 2025 Tecomred. Todos los derechos reservados.</p>
    </footer>

    <div class="chat-bot-container">
        <button id="chat-bot-btn" class="chat-bot-btn" aria-label="Abrir chat con el bot de la tienda" aria-expanded="false" aria-controls="chat-window">
            <i class="fas fa-robot"></i>
        </button>
        <div id="chat-window" class="chat-window" style="display:none;" aria-hidden="true">
            <div class="chat-header">
                <h3>Asistente Tecomred</h3>
                <button id="chat-close-btn" class="chat-close-btn" aria-label="Cerrar chat">×</button>
            </div>
            <div id="chat-messages" class="chat-messages">
                <div class="chat-message message-bot">
                    ¡Hola! Soy tu asistente virtual. ¿En qué puedo ayudarte hoy?
                </div>
            </div>
            <div class="chat-input-area">
                <input type="text" id="chat-input" class="chat-input" placeholder="Escribe tu mensaje..." aria-label="Escribir mensaje al bot">
                <button id="chat-send-btn" class="chat-send-btn" aria-label="Enviar mensaje"><i class="fas fa-paper-plane"></i></button>
            </div>
        </div>
    </div>

    <div id="login-modal" class="modal" aria-labelledby="login-title" aria-modal="true" role="dialog" style="display:none;">
        <div class="modal-contenido">
            <h2 id="login-title">Iniciar Sesión</h2>
            <button class="cerrar-modal" aria-label="Cerrar ventana de inicio de sesión">×</button>
            <form id="login-form" class="auth-form">
                <div class="grupo-formulario">
                    <label for="login-email">Correo Electrónico:</label>
                    <input type="email" id="login-email" required autocomplete="email" />
                </div>
                <div class="grupo-formulario">
                    <label for="login-password">Contraseña:</label>
                    <input type="password" id="login-password" required autocomplete="current-password" />
                </div>
                <button type="submit" class="btn-primario">Entrar</button>
                <p class="auth-link">¿Olvidaste tu contraseña? <a href="#" id="forgot-password-link">Recuperar cuenta</a></p>
                <p class="auth-link">¿No tienes cuenta? <a href="#" id="go-to-register">Regístrate aquí</a></p>
                <p id="login-message" class="auth-message"></p>
            </form>
        </div>
    </div>
    <div id="register-modal" class="modal" aria-labelledby="register-title" aria-modal="true" role="dialog" style="display:none;">
        <div class="modal-contenido">
            <h2 id="register-title">Registrarse</h2>
            <button class="cerrar-modal" aria-label="Cerrar ventana de registro">×</button>
            <form id="register-form" class="auth-form">
                <div class="grupo-formulario">
                    <label for="register-email">Correo Electrónico:</label>
                    <input type="email" id="register-email" required autocomplete="email" />
                </div>
                <div class="grupo-formulario">
                    <label for="register-password">Contraseña:</label>
                    <input type="password" id="register-password" required autocomplete="new-password" />
                </div>
                <button type="submit" class="btn-primario">Crear Cuenta</button>
                <p class="auth-link">¿Ya tienes cuenta? <a href="#" id="go-to-login">Inicia Sesión aquí</a></p>
                <p id="register-message" class="auth-message"></p>
            </form>
        </div>
    </div>
    <div id="forgot-password-modal" class="modal" aria-labelledby="forgot-password-title" aria-modal="true" role="dialog" style="display:none;">
        <div class="modal-contenido">
            <h2 id="forgot-password-title">Recuperar Contraseña</h2>
            <button class="cerrar-modal" aria-label="Cerrar ventana de recuperación de contraseña">×</button>
            <form id="forgot-password-form" class="auth-form">
                <p>Introduce tu correo electrónico y te enviaremos un enlace para restablecer tu contraseña.</p>
                <div class="grupo-formulario">
                    <label for="forgot-email">Correo Electrónico:</label>
                    <input type="email" id="forgot-email" required autocomplete="email" />
                </div>
                <button type="submit" class="btn-primario">Enviar Enlace de Recuperación</button>
                <p class="auth-link">Volver a <a href="#" id="back-to-login">Iniciar Sesión</a></p>
                <p id="forgot-password-message" class="auth-message"></p>
            </form>
        </div>
    </div>
    
    <script>
        // Data de productos (simulada)
        const productos = [
            { id: 1, nombre: 'Laptop HP Pavilion', precio: 2500.00, categoria: 'Laptops', imagen: 'https://cdn.pixabay.com/photo/2016/11/29/03/48/laptop-1867160_960_720.jpg' },
            { id: 2, nombre: 'Mouse Inalámbrico Logitech', precio: 85.50, categoria: 'Accesorios', imagen: 'https://cdn.pixabay.com/photo/2016/09/20/09/16/computer-mouse-1682390_960_720.jpg' },
            { id: 3, nombre: 'Teclado Mecánico Corsair', precio: 350.00, categoria: 'Accesorios', imagen: 'https://cdn.pixabay.com/photo/2016/11/29/08/30/keyboard-1868351_960_720.jpg' },
            { id: 4, nombre: 'Router TP-Link WiFi 6', precio: 280.99, categoria: 'Redes', imagen: 'https://cdn.pixabay.com/photo/2021/04/21/11/39/router-6195655_960_720.jpg' },
            { id: 5, nombre: 'SSD Kingston 1TB', precio: 450.00, categoria: 'Componentes', imagen: 'https://cdn.pixabay.com/photo/2018/02/05/01/29/hard-drive-3131093_960_720.jpg' },
            { id: 6, nombre: 'Cable HDMI 4K', precio: 45.00, categoria: 'Accesorios', imagen: 'https://cdn.pixabay.com/photo/2017/02/10/14/06/cable-2055106_960_720.jpg' },
            { id: 7, nombre: 'Memoria RAM 16GB', precio: 220.00, categoria: 'Componentes', imagen: 'https://cdn.pixabay.com/photo/2018/03/26/19/23/ram-3264104_960_720.jpg' },
            { id: 8, nombre: 'Tarjeta de Video RTX 4070', precio: 3200.00, categoria: 'Componentes', imagen: 'https://cdn.pixabay.com/photo/2023/04/24/18/43/graphics-card-7948834_960_720.jpg' },
            { id: 9, nombre: 'Laptop Lenovo ThinkPad', precio: 3500.00, categoria: 'Laptops', imagen: 'https://cdn.pixabay.com/photo/2014/05/02/21/50/laptop-336373_960_720.jpg' },
            { id: 10, nombre: 'Adaptador USB C', precio: 60.00, categoria: 'Accesorios', imagen: 'https://cdn.pixabay.com/photo/2023/04/05/00/03/usb-7899738_960_720.jpg' }
        ];
        
        // Elementos del DOM
        const contenedorProductos = document.getElementById('contenedor-productos');
        const listaCarrito = document.getElementById('lista-carrito');
        const carritoTotalSpan = document.getElementById('carrito-total');
        const carritoVacioMensaje = document.getElementById('carrito-vacio-mensaje');
        const btnVaciar = document.getElementById('btn-vaciar');
        const btnIrAPagar = document.getElementById('btn-ir-pago');
        const filtroCategoria = document.getElementById('filtro-categoria');
        const filtroPrecio = document.getElementById('filtro-precio');
        const precioMostrar = document.getElementById('precio-mostrar');
        const buscador = document.getElementById('buscador');
        const noProductosMensaje = document.getElementById('no-productos-mensaje');
        
        // Elementos para el carrito (sidebar)
        const btnMostrarCarrito = document.getElementById('mostrar-carrito');
        const btnOcultarCarrito = document.getElementById('ocultar-carrito');
        const carritoAside = document.getElementById('carrito');

        // Modales de autenticación (sin cambios)
        const loginBtn = document.getElementById('btn-login');
        const registerBtn = document.getElementById('btn-register');
        const logoutBtn = document.getElementById('btn-logout');
        const userDisplay = document.getElementById('user-display');
        const loginModal = document.getElementById('login-modal');
        const registerModal = document.getElementById('register-modal');
        const forgotPasswordModal = document.getElementById('forgot-password-modal');
        const closeLoginModalBtn = loginModal.querySelector('.cerrar-modal');
        const closeRegisterModalBtn = registerModal.querySelector('.cerrar-modal');
        const closeForgotPasswordModalBtn = forgotPasswordModal.querySelector('.cerrar-modal');
        const goToRegisterLink = document.getElementById('go-to-register');
        const goToLoginLink = document.getElementById('go-to-login');
        const forgotPasswordLink = document.getElementById('forgot-password-link');
        const backToLoginLink = document.getElementById('back-to-login');
        const loginForm = document.getElementById('login-form');
        const registerForm = document.getElementById('register-form');
        const forgotPasswordForm = document.getElementById('forgot-password-form');
        const loginMessage = document.getElementById('login-message');
        const registerMessage = document.getElementById('register-message');
        const forgotPasswordMessage = document.getElementById('forgot-password-message');

        // Botones y elementos del bot de chat
        const chatBotBtn = document.getElementById('chat-bot-btn');
        const chatWindow = document.getElementById('chat-window');
        const chatCloseBtn = document.getElementById('chat-close-btn');
        const chatMessages = document.getElementById('chat-messages');
        const chatInput = document.getElementById('chat-input');
        const chatSendBtn = document.getElementById('chat-send-btn');
        
        let carrito = [];

        // Funciones del Carrito
        function renderizarProductos(productosFiltrados) {
            contenedorProductos.innerHTML = '';
            if (productosFiltrados.length === 0) {
                noProductosMensaje.style.display = 'block';
            } else {
                noProductosMensaje.style.display = 'none';
                productosFiltrados.forEach(producto => {
                    const cardProducto = document.createElement('div');
                    cardProducto.classList.add('card-producto');
                    cardProducto.setAttribute('role', 'gridcell');
                    cardProducto.innerHTML = `
                        <img src="${producto.imagen}" alt="${producto.nombre}" loading="lazy">
                        <div class="card-body">
                            <h3>${producto.nombre}</h3>
                            <p>S/ ${producto.precio.toFixed(2)}</p>
                            <button class="btn-primario" data-id="${producto.id}" aria-label="Añadir ${producto.nombre} al carrito">Añadir al carrito</button>
                        </div>
                    `;
                    contenedorProductos.appendChild(cardProducto);
                });
            }
        }

        function renderizarCarrito() {
            listaCarrito.innerHTML = '';
            let total = 0;
            if (carrito.length === 0) {
                carritoVacioMensaje.style.display = 'block';
                btnVaciar.disabled = true;
                btnIrAPagar.disabled = true;
            } else {
                carritoVacioMensaje.style.display = 'none';
                btnVaciar.disabled = false;
                btnIrAPagar.disabled = false;
                carrito.forEach(item => {
                    const li = document.createElement('li');
                    li.innerHTML = `
                        <div class="carrito-item-info">
                            <h4>${item.nombre}</h4>
                            <p>S/ ${(item.precio * item.cantidad).toFixed(2)} (${item.cantidad} x S/ ${item.precio.toFixed(2)})</p>
                        </div>
                        <button class="btn-eliminar-item" data-id="${item.id}" aria-label="Eliminar ${item.nombre} del carrito">
                            <i class="fas fa-trash"></i>
                        </button>
                    `;
                    listaCarrito.appendChild(li);
                    total += item.precio * item.cantidad;
                });
            }
            carritoTotalSpan.textContent = total.toFixed(2);
        }

        function agregarAlCarrito(productoId) {
            const producto = productos.find(p => p.id === parseInt(productoId));
            if (!producto) return;

            const itemExistente = carrito.find(item => item.id === producto.id);
            if (itemExistente) {
                itemExistente.cantidad++;
            } else {
                carrito.push({ ...producto, cantidad: 1 });
            }
            renderizarCarrito();
        }

        function eliminarDelCarrito(productoId) {
            carrito = carrito.filter(item => item.id !== parseInt(productoId));
            renderizarCarrito();
        }

        function vaciarCarrito() {
            carrito = [];
            renderizarCarrito();
        }

        // Filtros y Buscador
        function aplicarFiltros() {
            const categoria = filtroCategoria.value;
            const precioMax = parseFloat(filtroPrecio.value);
            const textoBusqueda = buscador.value.toLowerCase();
            
            const productosFiltrados = productos.filter(producto => {
                const categoriaValida = (categoria === 'todos' || producto.categoria === categoria);
                const precioValido = (producto.precio <= precioMax);
                const busquedaValida = (producto.nombre.toLowerCase().includes(textoBusqueda));
                return categoriaValida && precioValido && busquedaValida;
            });
            renderizarProductos(productosFiltrados);
        }

        // Event Listeners
        contenedorProductos.addEventListener('click', (e) => {
            if (e.target.tagName === 'BUTTON' && e.target.textContent === 'Añadir al carrito') {
                agregarAlCarrito(e.target.dataset.id);
            }
        });

        listaCarrito.addEventListener('click', (e) => {
            if (e.target.closest('.btn-eliminar-item')) {
                eliminarDelCarrito(e.target.closest('.btn-eliminar-item').dataset.id);
            }
        });

        btnVaciar.addEventListener('click', vaciarCarrito);
        filtroCategoria.addEventListener('change', aplicarFiltros);
        filtroPrecio.addEventListener('input', () => {
            precioMostrar.textContent = `S/ ${filtroPrecio.value}`;
            aplicarFiltros();
        });
        buscador.addEventListener('input', aplicarFiltros);
        
        // Lógica de los modales de autenticación (sin cambios)
        function openModal(modal) {
            loginModal.style.display = 'none';
            registerModal.style.display = 'none';
            forgotPasswordModal.style.display = 'none';
            modal.style.display = 'block';
            modal.setAttribute('aria-hidden', 'false');
        }

        function closeModal(modal) {
            modal.style.display = 'none';
            modal.setAttribute('aria-hidden', 'true');
            loginMessage.textContent = '';
            registerMessage.textContent = '';
            forgotPasswordMessage.textContent = '';
            if (modal === loginModal) loginForm.reset();
            if (modal === registerModal) registerForm.reset();
            if (modal === forgotPasswordModal) forgotPasswordForm.reset();
        }

        loginBtn.addEventListener('click', () => openModal(loginModal));
        registerBtn.addEventListener('click', () => openModal(registerModal));
        closeLoginModalBtn.addEventListener('click', () => closeModal(loginModal));
        closeRegisterModalBtn.addEventListener('click', () => closeModal(registerModal));
        closeForgotPasswordModalBtn.addEventListener('click', () => closeModal(forgotPasswordModal));
        goToRegisterLink.addEventListener('click', (e) => { e.preventDefault(); openModal(registerModal); });
        goToLoginLink.addEventListener('click', (e) => { e.preventDefault(); openModal(loginModal); });
        forgotPasswordLink.addEventListener('click', (e) => { e.preventDefault(); openModal(forgotPasswordModal); });
        backToLoginLink.addEventListener('click', (e) => { e.preventDefault(); openModal(loginModal); });

        loginForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            if (email === 'test@example.com' && password === 'password123') {
                loginMessage.textContent = '¡Inicio de sesión exitoso!';
                loginMessage.style.color = 'green';
                setTimeout(() => {
                    closeModal(loginModal);
                    loginBtn.style.display = 'none';
                    registerBtn.style.display = 'none';
                    userDisplay.textContent = `Hola, ${email}`;
                    userDisplay.style.display = 'inline';
                    logoutBtn.style.display = 'inline';
                }, 1500);
            } else {
                loginMessage.textContent = 'Correo o contraseña incorrectos.';
                loginMessage.style.color = 'red';
            }
        });

        registerForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const email = document.getElementById('register-email').value;
            registerMessage.textContent = `Usuario ${email} registrado exitosamente.`;
            registerMessage.style.color = 'green';
            setTimeout(() => {
                closeModal(registerModal);
                openModal(loginModal);
            }, 2000);
        });

        forgotPasswordForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const email = document.getElementById('forgot-email').value;
            forgotPasswordMessage.textContent = `Se ha enviado un enlace de recuperación a ${email}.`;
            forgotPasswordMessage.style.color = 'green';
            setTimeout(() => {
                closeModal(forgotPasswordModal);
                openModal(loginModal);
            }, 2000);
        });

        logoutBtn.addEventListener('click', () => {
            userDisplay.style.display = 'none';
            logoutBtn.style.display = 'none';
            loginBtn.style.display = 'inline';
            registerBtn.style.display = 'inline';
            userDisplay.textContent = '';
            alert('Has cerrado sesión.');
        });

        window.addEventListener('click', (event) => {
            if (event.target === loginModal) closeModal(loginModal);
            if (event.target === registerModal) closeModal(registerModal);
            if (event.target === forgotPasswordModal) closeModal(forgotPasswordModal);
        });
        
        // Lógica para el pago (sin cambios)
        const metodoPagoSelect = document.getElementById('metodo');
        const detallesPagoTarjeta = document.getElementById('detalles-pago-tarjeta');

        metodoPagoSelect.addEventListener('change', () => {
            if (metodoPagoSelect.value === 'tarjeta') {
                detallesPagoTarjeta.style.display = 'block';
            } else {
                detallesPagoTarjeta.style.display = 'none';
            }
        });

        // Lógica del Bot de Chat
        function toggleChatWindow() {
            const isHidden = chatWindow.style.display === 'none';
            chatWindow.style.display = isHidden ? 'flex' : 'none';
            chatWindow.setAttribute('aria-hidden', !isHidden);
            chatBotBtn.setAttribute('aria-expanded', isHidden);
            if (!isHidden) chatInput.focus();
        }

        function agregarMensaje(texto, remitente) {
            const mensajeDiv = document.createElement('div');
            mensajeDiv.classList.add('chat-message', `message-${remitente}`);
            mensajeDiv.textContent = texto;
            chatMessages.appendChild(mensajeDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight; // Scroll automático
        }

        function responderBot(mensaje) {
            const mensajeLower = mensaje.toLowerCase();
            let respuesta = 'Lo siento, no entiendo esa pregunta. Puedes preguntar sobre nuestros productos, servicios o horarios.';
            
            if (mensajeLower.includes('hola') || mensajeLower.includes('saludos')) {
                respuesta = '¡Hola! ¿Cómo puedo ayudarte hoy?';
            } else if (mensajeLower.includes('productos') || mensajeLower.includes('venta') || mensajeLower.includes('laptops') || mensajeLower.includes('accesorios')) {
                respuesta = 'Claro, vendemos laptops, componentes, redes y accesorios. Puedes verlos en la sección "Productos".';
            } else if (mensajeLower.includes('servicio tecnico') || mensajeLower.includes('mantenimiento') || mensajeLower.includes('reparacion')) {
                respuesta = 'Ofrecemos servicio técnico para laptops y PCs. Contáctanos para más detalles.';
            } else if (mensajeLower.includes('horario') || mensajeLower.includes('atienden')) {
                respuesta = 'Nuestro horario de atención es de lunes a sábado de 9:00 a.m. a 7:00 p.m.';
            } else if (mensajeLower.includes('ubicacion') || mensajeLower.includes('direccion')) {
                respuesta = 'Estamos ubicados en Jr. Sinchi Roca #391, Baños del Inca, Cajamarca. ¡Te esperamos!';
            } else if (mensajeLower.includes('pago') || mensajeLower.includes('pagar')) {
                respuesta = 'Aceptamos varios métodos de pago, como tarjeta de crédito/débito, transferencia bancaria y Yape/Plin.';
            }

            setTimeout(() => {
                agregarMensaje(respuesta, 'bot');
            }, 1000);
        }

        chatBotBtn.addEventListener('click', toggleChatWindow);
        chatCloseBtn.addEventListener('click', toggleChatWindow);

        chatSendBtn.addEventListener('click', () => {
            const mensaje = chatInput.value.trim();
            if (mensaje) {
                agregarMensaje(mensaje, 'user');
                responderBot(mensaje);
                chatInput.value = '';
            }
        });

        chatInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                chatSendBtn.click();
            }
        });

        // Lógica para el sidebar del carrito
        btnMostrarCarrito.addEventListener('click', () => {
            carritoAside.classList.add('abierto');
            carritoAside.setAttribute('aria-hidden', 'false');
            btnMostrarCarrito.setAttribute('aria-expanded', 'true');
        });
        btnOcultarCarrito.addEventListener('click', () => {
            carritoAside.classList.remove('abierto');
            carritoAside.setAttribute('aria-hidden', 'true');
            btnMostrarCarrito.setAttribute('aria-expanded', 'false');
        });

        // Inicializar la página
        document.addEventListener('DOMContentLoaded', () => {
            renderizarProductos(productos);
            renderizarCarrito();
        });

    </script>
</body>
</html>
